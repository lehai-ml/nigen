<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>nimagen package &mdash; NIMAGEN 0.0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="nimagen" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> NIMAGEN
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">nimagen</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">nimagen package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-nimagen.genes">nimagen.genes module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-nimagen.graph">nimagen.graph module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-nimagen.stats">nimagen.stats module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-nimagen.visualisation">nimagen.visualisation module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-nimagen">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NIMAGEN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">nimagen</a></li>
      <li class="breadcrumb-item active">nimagen package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/nimagen.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nimagen-package">
<h1>nimagen package<a class="headerlink" href="#nimagen-package" title="Permalink to this headline"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-nimagen.genes">
<span id="nimagen-genes-module"></span><h2>nimagen.genes module<a class="headerlink" href="#module-nimagen.genes" title="Permalink to this headline"></a></h2>
<p>”
genes.py
perform gene/gene-set analysis</p>
<dl class="simple">
<dt>Following steps are available:</dt><dd><dl class="simple">
<dt>SNPsFunctionalAnalysis</dt><dd><p>extract_new_bed_file
do_mass_univariate_test - perform mass univariate test on each SNP
get_the_best_SNPs
SNPs_annotation_to_gene</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="nimagen.genes.SNPsFunctionalAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nimagen.genes.</span></span><span class="sig-name descname"><span class="pre">SNPsFunctionalAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snps_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bed_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bed_reader._open_bed.open_bed</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/genes.html#SNPsFunctionalAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.genes.SNPsFunctionalAnalysis" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Functional analysis pipeline</p>
<dl class="py method">
<dt class="sig sig-object py" id="nimagen.genes.SNPsFunctionalAnalysis.SNPs_annotation_to_gene">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SNPs_annotation_to_gene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snps_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_build_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nimagen/genes.html#SNPsFunctionalAnalysis.SNPs_annotation_to_gene"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.genes.SNPsFunctionalAnalysis.SNPs_annotation_to_gene" title="Permalink to this definition"></a></dt>
<dd><p>[Annotate SNPs to gene]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snps_list</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – [SNPs list of interest]</p></li>
<li><p><strong>gene_build_path</strong> (<em>str</em>) – [path to A gene_build downloaded from <a class="reference external" href="https://ctg.cncr.nl/software/magma">https://ctg.cncr.nl/software/magma</a>]</p></li>
<li><p><strong>window_size</strong> (<em>int</em><em>, </em><em>optional</em>) – [Symmetric up and down stream window in kilobases from the gene position]. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[genes_ID: table of genes and corresponding snps, snp_ID: table of SNPs, and corresponding genes]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[pd.core.frame.DataFrame]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Can be compared with MAGMA annotation file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.genes.SNPsFunctionalAnalysis.do_mass_univariate_test">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">do_mass_univariate_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orig_bed_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bed_reader._open_bed.open_bed</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pheno_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covar_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pheno_covar_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snps_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phenotype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">updated_bed_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bed_reader._open_bed.open_bed</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/nimagen/genes.html#SNPsFunctionalAnalysis.do_mass_univariate_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.genes.SNPsFunctionalAnalysis.do_mass_univariate_test" title="Permalink to this definition"></a></dt>
<dd><p>[Perform linear association for each SNP with the phenotype]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bed_file</strong> (<em>str</em>) – [A bed_reader input, this is a bed file]</p></li>
<li><p><strong>pheno_file_path</strong> (<em>str</em>) – </p></li>
<li><p><strong>covar_file_path</strong> (<em>str</em>) – </p></li>
<li><p><strong>phenotype</strong> (<em>str</em><em>, </em><em>optional</em>) – [The phenotype of interest]. Defaults to ‘WM_sum’.</p></li>
<li><p><strong>covariate</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – [List of phenotypes of interest]. Defaults to [‘euro_Anc_PC1’, ‘euro_Anc_PC2’, ‘euro_Anc_PC3’, ‘GA_vol’, ‘PMA_vol’, ‘Gender’, ‘Intracranial_Imperial’].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[Dataframe, where each row contains result of univariate test for individual SNP]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ouput can be compared with the plink linear association file.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.genes.SNPsFunctionalAnalysis.extract_new_bed_file">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extract_new_bed_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bed_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bed_reader._open_bed.open_bed</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snps_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fid_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bed_reader._open_bed.open_bed</span></span></span><a class="reference internal" href="_modules/nimagen/genes.html#SNPsFunctionalAnalysis.extract_new_bed_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.genes.SNPsFunctionalAnalysis.extract_new_bed_file" title="Permalink to this definition"></a></dt>
<dd><p>[Return a new bed_file object, with selected individual and selected genotyped data]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snps_list</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) – [list of snps]</p></li>
<li><p><strong>fid_list</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>pd.DataFrame</em><em>, </em><em>str</em><em>, </em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em><em>]</em>) – [list of fid, can be either pd.Dataframe, and it will look for FID column, or path to the dataframe.]</p></li>
<li><p><strong>bed_file</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>bed_reader.open_bed</em><em>]</em>) – [the bed file, or path to the bed file]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[New bed file object with the necessary information for the SNPsFunctionalAnalysis pipeline]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bed_reader.open_bed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.genes.SNPsFunctionalAnalysis.get_the_best_SNPs">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_the_best_SNPs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snp_association</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcolumn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'P'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/nimagen/genes.html#SNPsFunctionalAnalysis.get_the_best_SNPs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.genes.SNPsFunctionalAnalysis.get_the_best_SNPs" title="Permalink to this definition"></a></dt>
<dd><p>Retain only the SNPs that past through a threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snp_association</strong> (<em>_type_</em>) – dataframe with column names P for p-value and SNP for snps</p></li>
<li><p><strong>threshold</strong> (<em>_type_</em>) – the p-value threshold. Remove all snps that has association strength less than this.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-nimagen.graph">
<span id="nimagen-graph-module"></span><h2>nimagen.graph module<a class="headerlink" href="#module-nimagen.graph" title="Permalink to this headline"></a></h2>
<p>graph.py
Used to perform graph analysis and network based threshold statistics</p>
<dl class="py class">
<dt class="sig sig-object py" id="nimagen.graph.Graph_analysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nimagen.graph.</span></span><span class="sig-name descname"><span class="pre">Graph_analysis</span></span><a class="reference internal" href="_modules/nimagen/graph.html#Graph_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.Graph_analysis" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.Graph_analysis.combine_nodes_together">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">combine_nodes_together</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">idx_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">operation_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/graph.html#Graph_analysis.combine_nodes_together"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.Graph_analysis.combine_nodes_together" title="Permalink to this definition"></a></dt>
<dd><p>Group the nodes together by summing their values in matrix (or mean, max)
Return the new matrix or new names of the updated list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>np.ndarray</em>) – Matrix undirected of size (nodes,nodes).</p></li>
<li><p><strong>*idx_args</strong> (<em>List</em><em> or </em><em>arrays</em>) – Series of list or arrays, where each list is a group of nodes separated by comma.</p></li>
<li><p><strong>**operation_kwargs</strong> (<em>TYPE</em>) – <p>operation: {‘sum’,’mean’,’max’}
grouped_node_list List or dict:</p>
<blockquote>
<div><p>if dict: key = name of the group, value = indices in the group, idx_args is not required
if list: this is list of name that correspond to each group. Must match the number of list in idx_args</p>
</div></blockquote>
<p>original_node_list: Original list of name for each node</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If X is not undirected.
    If number of grouped idx is less than 2</p></li>
<li><p><strong>KeyError</strong> – If providing grouped node list without original node list</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>X_new</strong> (<em>np.ndarray</em>) – Updated grouped X</p></li>
<li><p><strong>Grouped node list</strong> (<em>np.ndarray</em>) – Grouped node list, the position of each value correspond to each node.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.Graph_analysis.get_components">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/graph.html#Graph_analysis.get_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.Graph_analysis.get_components" title="Permalink to this definition"></a></dt>
<dd><p>Returns the components of an undirected graph specified by the binary and
undirected adjacency matrix adj. Components and their constitutent nodes
are assigned the same index and stored in the vector, comps. The vector,
comp_sizes, contains the number of nodes beloning to each component.
.. note:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Taken</span> <span class="n">directly</span> <span class="kn">from</span> <span class="nn">bct.clustering.get_components</span>
<span class="n">Cite</span> <span class="n">accordingly</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<em>np.ndarray</em>) – binarised matrix, the diagonal may not be 1.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If X is not undirected.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>comps</strong> (<em>np.ndarray</em>) – list of the size of number of nodes, where each location is the component the node belong to.
e.g. [1,1,2,2] means the first two nodes belong to component 1, and the last 2 in component 2</p></li>
<li><p><strong>comp_sizes</strong> (<em>np.ndarray</em>) – Size of each component in terms of number of nodes.</p></li>
<li><p><strong>max_edge_size</strong> (<em>float</em>)</p></li>
<li><p><em>Note</em> – Unconnected nodes will have their own index component and component size of 1
How do you calculate the size of a connected component?
You obviously want to count the edges.
But because unconnected nodes will have the size node of 1, you need to remove them</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.Graph_analysis.get_degree_und">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_degree_und</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/graph.html#Graph_analysis.get_degree_und"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.Graph_analysis.get_degree_und" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.Graph_analysis.get_edge_size">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_edge_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/graph.html#Graph_analysis.get_edge_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.Graph_analysis.get_edge_size" title="Permalink to this definition"></a></dt>
<dd><p>Calculate for each connected component the edge size.
The unconnected nodes are coded as an independent number with comp_sizes of 1.
First we need to remove these unconnected nodes and retain only connected components.
Then for each connected component, we find the nodes in that connected component.
From there, we can look at the lower half of the binarised matrix, and count number of 1s in the matrix containing only those nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>np.ndarray</em>) – the binarised squared symmetric matrix.</p></li>
<li><p><strong>comps</strong> (<em>np.ndarray</em>) – list of the size of number of nodes, where each location is the component the node belong to.
e.g. [1,1,2,2] means the first two nodes belong to component 1, and the last 2 in component 2</p></li>
<li><p><strong>comp_sizes</strong> (<em>np.ndarray</em>) – Size of each component in terms of number of nodes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ind_sz</strong> (<em>np.ndarray</em>) – This tells me which components id is connected [1,2] means component id 1, and 2 are connected.</p></li>
<li><p><strong>sz_links</strong> (<em>np.ndarray</em>) – This tells me for each component in ind_sz, how many edges there is.</p></li>
<li><p><strong>max_edge_size</strong> (<em>float</em>) – The max of sz_links. If sz_links = 0, then max_edge_size = 0.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.Graph_analysis.lower_triangle">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lower_triangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/graph.html#Graph_analysis.lower_triangle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.Graph_analysis.lower_triangle" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Works in Diffusion dataset. Organizes a square unidirectional matrix into 1D vector. Because the matrix</dt><dd><p>is unidirectional, only the lower triangle is needed.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>matrix</strong> (<em>np.array</em>) – the square matrix</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1D vector of the lower half.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>new_array(np.array)</p>
</dd>
</dl>
<p>Example:
0 1 2 3
1 0 3 4
2 3 0 5====&gt;[1,2,3,3,4,5]
3 4 5 0</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.Graph_analysis.remove_nodes">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">remove_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes_to_remove</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_node_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/graph.html#Graph_analysis.remove_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.Graph_analysis.remove_nodes" title="Permalink to this definition"></a></dt>
<dd><p>Removes the nodes from the matrix and return a new matrix and list of updated nodes name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>np.ndarray</em>) – Matrix undirected of size (nodes,nodes)..</p></li>
<li><p><strong>nodes_to_remove</strong> (<em>np.ndarray</em>) – Index of nodes in the matrix that needs to be removed.</p></li>
<li><p><strong>original_node_list</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Name of the nodes in the matrix. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If X is not undirected.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>new_X</strong> (<em>np.ndarray</em>) – new updated matrix.</p></li>
<li><p><strong>updated_node_list</strong> (<em>List</em>) – list of updated node names</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.Graph_analysis.reverse_lower_triangle">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reverse_lower_triangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_of_the_square</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/graph.html#Graph_analysis.reverse_lower_triangle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.Graph_analysis.reverse_lower_triangle" title="Permalink to this definition"></a></dt>
<dd><p>Organise a 1D matrix to a square 2D undirected matrix.
:param matrix: 1D matrix
:param side_of_the_square: desired square size
:type side_of_the_square: int</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>2D matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>matrix</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nimagen.graph.NBS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nimagen.graph.</span></span><span class="sig-name descname"><span class="pre">NBS</span></span><a class="reference internal" href="_modules/nimagen/graph.html#NBS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.NBS" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py class">
<dt class="sig sig-object py" id="nimagen.graph.NBS.Corr_matrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Corr_matrix</span></span><a class="reference internal" href="_modules/nimagen/graph.html#NBS.Corr_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.NBS.Corr_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.NBS.Corr_matrix.calculate_adj_corr_matrix">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_adj_corr_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_permute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/graph.html#NBS.Corr_matrix.calculate_adj_corr_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.NBS.Corr_matrix.calculate_adj_corr_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.NBS.Corr_matrix.get_permutation_corr_matrix">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_permutation_corr_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_permute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/graph.html#NBS.Corr_matrix.get_permutation_corr_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.NBS.Corr_matrix.get_permutation_corr_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nimagen.graph.NBS.T_matrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">T_matrix</span></span><a class="reference internal" href="_modules/nimagen/graph.html#NBS.T_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.NBS.T_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.NBS.T_matrix.calculate_t_matrix">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_t_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/graph.html#NBS.T_matrix.calculate_t_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.NBS.T_matrix.calculate_t_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Calculate t-value by performing mass linear regression.
Utilises scipy.linalg.lstsq lapack driver = ‘gelsy’
Each linear regression model has a bias term, but t-value of only the predictor is outputed.
:param X: Matrix of shape (n,K) where n is the number of observation and K is the number of connections.
:type X: np.ndarray
:param y: The target continuous variable, which will be shuffled in permutation testing.
:type y: np.ndarray</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>t_matrix</strong> – Assuming the undirected graph, this is a (K,) vector where t_matrix[0] correspond to the t-value of the K[0] in linear regression model with a bias term.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.NBS.T_matrix.get_permutation">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_permutation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="_modules/nimagen/graph.html#NBS.T_matrix.get_permutation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.NBS.T_matrix.get_permutation" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>np.ndarray</em>) – Matrix of shape (n,K) where n is the number of observation and K is the number of connections.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – The target continuous variable, which will be shuffled in permutation testing</p></li>
<li><p><strong>perm</strong> (<em>int</em><em>, </em><em>optional</em>) – number of permutation. The default is 1000. uses np.random.Generator.permutation (without replacement)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>all_t_perm</strong> – A t-value matrix of shape (perm,K) where perm is the number of permutation performed, and K is the number of connection examined.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.NBS.get_null_distribution">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_null_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">permutation_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/graph.html#NBS.get_null_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.NBS.get_null_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Applying a t-value threshold to the t-value matrix derived from permutation step.
And calculate the maximal size of the connected component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_t_perm</strong> (<em>np.ndarray</em>) – A t-value matrix of shape (perm,K) where perm is the number of permutation performed, and K is the number of connection examined..</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – The threshold to be applied to all_t_perm.</p></li>
<li><p><strong>number_of_nodes</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of nodes examined.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – {‘max_edge_size’,’max_degree_centrality’}</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>null_distribution</strong> – Vector of shape (perm,), at each position is the maximal edge size for each permutation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.graph.NBS.get_p_val">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_p_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observed_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">null_distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/graph.html#NBS.get_p_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.graph.NBS.get_p_val" title="Permalink to this definition"></a></dt>
<dd><p>Get p value for each connected component in the observed data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>np.ndarray</em>) – Matrix of shape (n,K) where n is the number of observation and K is the number of connections.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – The target continuous variable, which will be shuffled in permutation testing.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – The t-value threshold to be applied to t-value matrix.</p></li>
<li><p><strong>null_distribution</strong> (<em>np.ndarray</em>) – Vector of shape (perm,), at each position is the maximal edge size for each permutation.</p></li>
<li><p><strong>number_of_nodes</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of nodes examined. The default is 90.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>p_vals</strong> (<em>np.ndarray</em>) – Matrix of shape (nr_connected_component,) corresponding to p-value at each connected component</p></li>
<li><p><strong>comps</strong> (<em>np.ndarray</em>) – list of the size of number of nodes, where each location is the component the node belong to.
e.g. [1,1,2,2] means the first two nodes belong to component 1, and the last 2 in component 2</p></li>
<li><p><strong>ind_sz</strong> (<em>np.ndarray</em>) – This tells me which components id is connected [1,2] means component id 1, and 2 are connected.</p></li>
<li><p><strong>sz_links</strong> (<em>np.ndarray</em>) – This tells me for each component in ind_sz, how many edges there is.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-nimagen.stats">
<span id="nimagen-stats-module"></span><h2>nimagen.stats module<a class="headerlink" href="#module-nimagen.stats" title="Permalink to this headline"></a></h2>
<p>stats.py
Uses to perform mass univariate and everything related to it</p>
<dl class="py class">
<dt class="sig sig-object py" id="nimagen.stats.MassUnivariate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nimagen.stats.</span></span><span class="sig-name descname"><span class="pre">MassUnivariate</span></span><a class="reference internal" href="_modules/nimagen/stats.html#MassUnivariate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.MassUnivariate" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.MassUnivariate.adjust_covariates_with_lin_reg">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">adjust_covariates_with_lin_reg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cont_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_model_adjuster</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">massunivariatekwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/nimagen/stats.html#MassUnivariate.adjust_covariates_with_lin_reg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.MassUnivariate.adjust_covariates_with_lin_reg" title="Permalink to this definition"></a></dt>
<dd><p>Adjusting covariates by using linear regression</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em>, </em><em>optional</em>) – The dataframe if providing strings as covariates. The default is None.</p></li>
<li><p><strong>cat_independentVar_cols</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>,</em><em>np.ndarray</em><em>,</em><em>pd.DataFrame</em><em>,</em><em>pd.Series</em><em>]</em><em>, </em><em>optional</em>) – The categorical variables. The default is None.</p></li>
<li><p><strong>cont_independentVar_cols</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>,</em><em>np.ndarray</em><em>,</em><em>pd.DataFrame</em><em>,</em><em>pd.Series</em><em>]</em><em>, </em><em>optional</em>) – The continuous variables. The default is None.</p></li>
<li><p><strong>dependentVar_cols</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>,</em><em>np.ndarray</em><em>,</em><em>pd.DataFrame</em><em>,</em><em>pd.Series</em><em>]</em><em>, </em><em>optional</em>) – The variables needed to be adjusted. The default is None.</p></li>
<li><p><strong>return_model_adjuster</strong> (<em>bool</em>) – Return a dictionary of linear models used to fit.</p></li>
<li><p><strong>*massunivariatekwargs</strong> (<em>dict</em>) – Anything from the MassUnivariate.mass_univariate function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The dataframe of the adjusted variables, the columns will be the same as the one provided. The index will be the same as the df if provided.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.MassUnivariate.calculate_R_squared_explained">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_R_squared_explained</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_to_drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/nimagen/stats.html#MassUnivariate.calculate_R_squared_explained"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.MassUnivariate.calculate_R_squared_explained" title="Permalink to this definition"></a></dt>
<dd><p>[Calculate R squared explained from the model]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>[</em><em>pd.DataFrame</em><em>]</em>) – [the model to be passed to the univariate model]</p></li>
<li><p><strong>col_to_drop</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – [the column names of the data frame to be removed in the univariate model]. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – </p></li>
<li><p><strong>cat_independentVar_cols</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>List</em><em>[</em><em>np.ndarray</em><em>]</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – [list of categorical variables, such that they will be converted to dummies by pandas]. Defaults to None.</p></li>
<li><p><strong>cont_independentVar_cols</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>List</em><em>[</em><em>np.ndarray</em><em>]</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – [list of continuous variables, they will be appended to cat_independentVar_cols]. Defaults to None.</p></li>
<li><p><strong>dependentVar_cols</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>List</em><em>[</em><em>np.ndarray</em><em>]</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – [the dependent variable, the ]. Defaults to None.</p></li>
<li><p><strong>[</strong><strong>str</strong><strong>]</strong> (<em>scaling</em>) – Default = both. (‘x’,’y’,’both’,’none’)</p></li>
<li><p><strong>none</strong> (<em>If</em>) – </p></li>
<li><p><strong>scaler</strong> (<em>we will not perform standard</em>) – </p></li>
<li><p><strong>x</strong> (<em>'both' we will perform on both</em>) – </p></li>
<li><p><strong>additional_info</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [additional columns to be appended]. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[difference in the full and the null model R squared]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.MassUnivariate.calculate_mass_univariate_across_multiple_thresholds">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_mass_univariate_across_multiple_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cont_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/nimagen/stats.html#MassUnivariate.calculate_mass_univariate_across_multiple_thresholds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.MassUnivariate.calculate_mass_univariate_across_multiple_thresholds" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – the dataframe.</p></li>
<li><p><strong>thresholds</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – DESCRIPTION.</p></li>
<li><p><strong>descriptions</strong> (<em>see MassUnivariate.mass_univariate for full variable</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_df</strong> – DESCRIPTION.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.MassUnivariate.check_all_predictors_combo_linear_Reg">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">check_all_predictors_combo_linear_Reg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cont_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_plan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/stats.html#MassUnivariate.check_all_predictors_combo_linear_Reg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.MassUnivariate.check_all_predictors_combo_linear_Reg" title="Permalink to this definition"></a></dt>
<dd><p>[Perform univariate test on all combinations of predictors]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>Optional</em><em>[</em><em>pd.DataFrame</em><em>]</em>) – [description]</p></li>
<li><p><strong>cat_independentVar_cols</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – [categorical variable]. Defaults to None.</p></li>
<li><p><strong>cont_independentVar_cols</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – [Continuous variables]. Defaults to None.</p></li>
<li><p><strong>dependentVar_cols</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – [description]. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.MassUnivariate.get_model_summary">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_model_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cont_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/stats.html#MassUnivariate.get_model_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.MassUnivariate.get_model_summary" title="Permalink to this definition"></a></dt>
<dd><p>Print model summary with Beta coefficient, Pvalues and R squared for an individual statsmodel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>MassUnivariate.mass_univariate</strong> (<em>*same arguments as</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result_df</strong> – DataFrame, index = independent Variable, columns = beta, p-value and Rsquared (fullmodel - null model)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.MassUnivariate.mass_univariate">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mass_univariate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cont_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_to_drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">statsmodels.regression.linear_model.RegressionResultsWrapper</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nimagen/stats.html#MassUnivariate.mass_univariate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.MassUnivariate.mass_univariate" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>[Returns the model and model summary</dt><dd><p>Performs univariate test, implements statsmodel.api.OLS]</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>Optional</em><em>[</em><em>pd.DataFrame</em><em>]</em>) – [pandas data frame, where each row is one observation]</p></li>
<li><p><strong>cat_independentVar_cols</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>List</em><em>[</em><em>np.ndarray</em><em>]</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – [list of categorical variables, such that they will be converted to dummies by pandas]. Defaults to None.</p></li>
<li><p><strong>cont_independentVar_cols</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>List</em><em>[</em><em>np.ndarray</em><em>]</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – [list of continuous variables, they will be appended to cat_independentVar_cols]. Defaults to None.</p></li>
<li><p><strong>dependentVar_cols</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>List</em><em>[</em><em>np.ndarray</em><em>]</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – [the dependent variable, the ]. Defaults to None.</p></li>
<li><p><strong>[</strong><strong>str</strong><strong>]</strong> (<em>scaling</em>) – Default = both. (‘x’,’y’,’both’,’none’)</p></li>
<li><p><strong>none</strong> (<em>If</em>) – </p></li>
<li><p><strong>scaler</strong> (<em>we will not perform standard</em>) – </p></li>
<li><p><strong>x</strong> (<em>'both' we will perform on both</em>) – </p></li>
<li><p><strong>model.</strong> (<em>col_to_drop</em><em> [</em><em>list</em><em>[</em><em>str</em><em>]</em><em>] </em><em>= if we want to remove any column from the independent Variable before fitting the</em>) – </p></li>
<li><p><strong>additional_info</strong> (<em>[</em><em>type</em><em>]</em><em>, </em><em>optional</em>) – [additional columns to be appended]. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[the statsmodel model and dataframe of the model summary, where cols are independent variables and const]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[sm.regression.linear_model.RegressionResultsWrapper, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.MassUnivariate.prepare_data">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cont_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_to_drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/stats.html#MassUnivariate.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.MassUnivariate.prepare_data" title="Permalink to this definition"></a></dt>
<dd><p>prepare the dependent and independent variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>Optional</strong><strong>[</strong><strong>pd.DataFrame</strong><strong>]</strong><strong>)</strong> (<em>df</em>) – </p></li>
<li><p><strong>(</strong><strong>Optional</strong><strong>[</strong><strong>Union</strong><strong>[</strong><strong>List</strong><strong>[</strong><strong>str</strong><strong>]</strong> (<em>dependentVar_cols</em>) – </p></li>
<li><p><strong>List</strong><strong>[</strong><strong>np.ndarray</strong><strong>]</strong><strong>]</strong><strong>]</strong> (<em>[</em><em>the dependent variable</em><em>, </em><em>the</em><em> ]</em><em>. Defaults to None.</em>) – </p></li>
<li><p><strong>optional</strong><strong>)</strong> (<em>[</em><em>the dependent variable</em><em>, </em><em>the</em><em> ]</em><em>. Defaults to None.</em>) – </p></li>
<li><p><strong>(</strong><strong>Optional</strong><strong>[</strong><strong>Union</strong><strong>[</strong><strong>List</strong><strong>[</strong><strong>str</strong><strong>]</strong> – </p></li>
<li><p><strong>List</strong><strong>[</strong><strong>np.ndarray</strong><strong>]</strong><strong>]</strong><strong>]</strong> – </p></li>
<li><p><strong>optional</strong><strong>)</strong> – </p></li>
<li><p><strong>(</strong><strong>Optional</strong><strong>[</strong><strong>Union</strong><strong>[</strong><strong>List</strong><strong>[</strong><strong>str</strong><strong>]</strong> – </p></li>
<li><p><strong>List</strong><strong>[</strong><strong>np.ndarray</strong><strong>]</strong><strong>]</strong><strong>]</strong> – </p></li>
<li><p><strong>optional</strong><strong>)</strong> – </p></li>
<li><p><strong>[</strong><strong>str</strong><strong>]</strong> (<em>scaling</em>) – </p></li>
<li><p><strong>none</strong> (<em>If</em>) – </p></li>
<li><p><strong>scaler</strong> (<em>we will not perform standard</em>) – </p></li>
<li><p><strong>target</strong><strong>)</strong> (<em>'both' we will perform on both x</em><em> (</em><em>independent variable- feature</em><em>) </em><em>and y</em><em> (</em><em>dependent variable-</em>) – </p></li>
<li><p><strong>model.</strong> (<em>col_to_drop</em><em> [</em><em>list</em><em>[</em><em>str</em><em>]</em><em>] </em><em>= if we want to remove any column from the independent Variable before fitting the</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – cat independentVar and cont independentVar needs to be list of strings, not list of list.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dependentvar and independentvar pd.DataFrames.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.MassUnivariate.preprocess_forward_selection">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">preprocess_forward_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nimagen/stats.html#MassUnivariate.preprocess_forward_selection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.MassUnivariate.preprocess_forward_selection" title="Permalink to this definition"></a></dt>
<dd><p>[Preprocess the info of mass univariate tests, all possible combo of predictors
Input is the output from <code class="docutils literal notranslate"><span class="pre">`check_all_predictors_combo_linear_Reg`</span></code>]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dictionary</strong> (<em>dict</em>) – [Output form <code class="docutils literal notranslate"><span class="pre">`check_all_predictors_combo_linear_Reg`</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[4 data frames - score_summary, variable combo summary, beta coefs, p-values]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.MassUnivariate.print_summary_table">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">print_summary_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cont_independentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependentVar_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/nimagen/stats.html#MassUnivariate.print_summary_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.MassUnivariate.print_summary_table" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variables</strong> (<em>see data_exploration.MassUnivariate.mass_univariate for full description of the</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>summary_table</strong> – The summary table containing R, Beta value, P-value for each dependent variable at each PRS threshold.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.MassUnivariate.remove_outliers">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">remove_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_schemes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'any'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage_of_outlier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject_ID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/nimagen/stats.html#MassUnivariate.remove_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.MassUnivariate.remove_outliers" title="Permalink to this definition"></a></dt>
<dd><p>[Remove outliers using the z-score (the same as using StandardScaler). The standard deviation]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – [Dataframe of interest]</p></li>
<li><p><strong>col</strong> (<em>str</em><em> or </em><em>List</em><em>, </em><em>optional</em>) – [column of interest]. Defaults to None.</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – [the threshold of the z-score]. Defaults to None.</p></li>
<li><p><strong>subject_ID</strong> (<em>list</em><em>, </em><em>optional</em>) – [Or gives me the list of subject IDs and remove by that way]. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[New data frame without the outliers]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nimagen.stats.Stability_tests">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nimagen.stats.</span></span><span class="sig-name descname"><span class="pre">Stability_tests</span></span><a class="reference internal" href="_modules/nimagen/stats.html#Stability_tests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.Stability_tests" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.Stability_tests.divide_high_low_risk">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">divide_high_low_risk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_perc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_perc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nimagen/stats.html#Stability_tests.divide_high_low_risk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.Stability_tests.divide_high_low_risk" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>[Divide the dataset into top and bottom x%. Here, we take the assumption that top percent is high risk and bottom percent is low risk.</dt><dd><p>While this method maximises the odd ratio for impacts, it raises concerns about the arbitrariness of the quantile used]</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – [the raw PRS score]</p></li>
<li><p><strong>high_perc</strong> (<em>float</em><em>, </em><em>optional</em>) – [higher risk group percentage]. Defaults to 0.1.</p></li>
<li><p><strong>low_perc</strong> (<em>float</em><em>, </em><em>optional</em>) – [lower risk group percentage]. Defaults to 0.3.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – [If high risk + low risk &gt; total subject, raise exception]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>[list of indices]</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Union[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.Stability_tests.perform_t_test">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">perform_t_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nimagen/stats.html#Stability_tests.perform_t_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.Stability_tests.perform_t_test" title="Permalink to this definition"></a></dt>
<dd><p>[perform t-test]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group_1</strong> (<em>np.ndarray</em>) – [The arrays must have the same shape, except in the dimension corresponding to axis]</p></li>
<li><p><strong>group_2</strong> (<em>np.ndarray</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[stats,pval]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.stats.Stability_tests.train_test_split_modified">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train_test_split_modified</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">stratify_by_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/nimagen/stats.html#Stability_tests.train_test_split_modified"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.Stability_tests.train_test_split_modified" title="Permalink to this definition"></a></dt>
<dd><p>[splitting the data based on several stratification]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>Union</em><em>[</em><em>pd.DataFrame</em><em>, </em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – [the data/ dataframe to be split]. Defaults to None.</p></li>
<li><p><strong>bins</strong> (<em>int</em><em>, </em><em>optional</em>) – [the bins used to separate the continuous data,
if it is too high, then due to small dataset, there might be error due to not enough data in each class]. Defaults to 4.</p></li>
<li><p><strong>together</strong> (<em>This works by concatenate multiple stratification criteria</em>) – </p></li>
<li><p><strong>successful</strong> (<em>and then attempt train test split. This is done at each level of stratification. If the stratificatio is not</em>) – </p></li>
<li><p><strong>number</strong> (<em>we reduce the bins</em>) – </p></li>
<li><p><strong>again.</strong> (<em>and try</em>) – </p></li>
<li><p><strong>succession</strong> (<em>This is done in</em>) – </p></li>
<li><p><strong>by</strong> (<em>so depending on what you want to stratify</em>) – </p></li>
<li><p><strong>GA_vol</strong> (<em>you put it earlier in the list. so</em>) – </p></li>
<li><p><strong>GA</strong> (<em>PMA_vol will stratify first by</em>) – </p></li>
<li><p><strong>PMA.</strong> (<em>and then</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>train and test set.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nimagen.stats.matSpDLite">
<span class="sig-prename descclassname"><span class="pre">nimagen.stats.</span></span><span class="sig-name descname"><span class="pre">matSpDLite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">correlation_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/stats.html#matSpDLite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.matSpDLite" title="Permalink to this definition"></a></dt>
<dd><p>Adapted from Nyholt DR R script.
Please cite
Nyholt DR (2004) A simple correction for multiple testing for SNPs in linkage disequilibrium with each other. Am J Hum Genet 74(4):765-769.
and
<a class="reference external" href="http://gump.qimr.edu.au/general/daleN/matSpDlite/">http://gump.qimr.edu.au/general/daleN/matSpDlite/</a>
and
Li and Ji 2005.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>correlation_matrix</strong> (<em>np.ndarray</em>) – The correlation matrix. It must be symmetric.</p></li>
<li><p><strong>alpha</strong> (<em>str</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is 0.05.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nimagen.stats.perform_CCA">
<span class="sig-prename descclassname"><span class="pre">nimagen.stats.</span></span><span class="sig-name descname"><span class="pre">perform_CCA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/stats.html#perform_CCA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.stats.perform_CCA" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-nimagen.visualisation">
<span id="nimagen-visualisation-module"></span><h2>nimagen.visualisation module<a class="headerlink" href="#module-nimagen.visualisation" title="Permalink to this headline"></a></h2>
<p>visualisation.py
This is a visualisation file, containing all the necessary visualisations.
You can draw simple plots, Bar or Scatter, or the Brain segmentation</p>
<dl class="py class">
<dt class="sig sig-object py" id="nimagen.visualisation.Brainmap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nimagen.visualisation.</span></span><span class="sig-name descname"><span class="pre">Brainmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atlas_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">nibabel.nifti1.Nifti1Image</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Spectral'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_reversed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/visualisation.html#Brainmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.Brainmap" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This is used to plot the brain visualisations using nibable</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">atlas_file</span> <span class="pre">=</span> <span class="pre">the</span> <span class="pre">nibabel</span> <span class="pre">loaded</span> <span class="pre">image</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">atlas</span> <span class="pre">=</span> <span class="pre">the</span> <span class="pre">numpy</span> <span class="pre">array</span> <span class="pre">representation</span> <span class="pre">of</span> <span class="pre">nifti</span> <span class="pre">image</span></span></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cmap</span> <span class="pre">=</span> <span class="pre">the</span> <span class="pre">color</span> <span class="pre">scheme</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.Brainmap.get_edges">
<span class="sig-name descname"><span class="pre">get_edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/visualisation.html#Brainmap.get_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.Brainmap.get_edges" title="Permalink to this definition"></a></dt>
<dd><p>used to get the visualise the segmentation outline</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.Brainmap.plot_segmentation">
<span class="sig-name descname"><span class="pre">plot_segmentation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/visualisation.html#Brainmap.plot_segmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.Brainmap.plot_segmentation" title="Permalink to this definition"></a></dt>
<dd><p>plot the segmentations with filled in color and legend</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.Brainmap.get_ROIs_coordinates">
<span class="sig-name descname"><span class="pre">get_ROIs_coordinates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/visualisation.html#Brainmap.get_ROIs_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.Brainmap.get_ROIs_coordinates" title="Permalink to this definition"></a></dt>
<dd><p>get the X,Y,Z coordinates of different regions in the Nifti file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_ROIs_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atlas_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">nibabel.nifti1.Nifti1Image</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/visualisation.html#Brainmap.get_ROIs_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd><p>Get ROIs coordinate where the x,y,z are the voxel indices.
:param atlas_file: pathway to nifti file or the nib.load nifti file.
:type atlas_file: Union[str,nib.nifti1.Nifti1Image]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>ROIs_coord</strong> – dictionary where for the key is label, and value is the x,y,z coordinates.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/visualisation.html#Brainmap.get_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Permalink to this definition"></a></dt>
<dd><p>Draw the edges of a structure.
:param outline: array of number, edges will be drawn around the edges of the non-zero structures.</p>
<blockquote>
<div><p>If two pixels next to each other are non-zero, then a black rectangle is drawn.
If two pixels are non-zero and not next to each other, then two black squares are drawn.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plot_segmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_view</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['all']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atlas_slice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions_to_hide</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_values_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.figure.Figure</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legends</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atlas_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">nibabel.nifti1.Nifti1Image</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Spectral'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_orientation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">figkwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/visualisation.html#Brainmap.plot_segmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Permalink to this definition"></a></dt>
<dd><p>Plot the brain segmentation</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Essentially, two brain maps are created.
The original brain map is used to create segmentation outline.
The second brain map is used to fill in the color.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map_view</strong> (<em>List</em><em>, </em><em>optional</em>) – {‘all’,’sagittal’,’axial’,’coronal’}. The default is [‘all’].</p></li>
<li><p><strong>atlas_slice</strong> (<em>int</em><em>,</em><em>list</em><em>, </em><em>dict</em><em>, </em><em>optional</em>) – dictionary keys: axial, coronal, sagittal, values = slice number
if list: three numbers corresponds to axial, coronal, sagittal
Choose which slice to show, else middle slice will be shown.</p></li>
<li><p><strong>regions_to_hide</strong> (<em>list</em><em>, </em><em>optional</em>) – Give the list of regions to hide (the regions must be list of intergers) The labels will be set to transparency 0. The default is None.</p></li>
<li><p><strong>plot_values</strong> (<em>Union</em><em>[</em><em>dict</em><em>]</em><em>, </em><em>optional</em>) – plot a color for each label denoting the strength of p-value or some other metrics.
If provide a dictionary, the key will be the label, and the value will be the value. The default is None.</p></li>
<li><p><strong>plot_values_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – A number that can be applied to plot_values and set the ones that do not pass the threshold to np.nan</p></li>
<li><p><strong>mask</strong> (<em>Union</em><em>[</em><em>dict</em><em>]</em><em>, </em><em>optional</em>) – Can pass a mask, that after passing the plot_values threshold, instead of plotting the original plot_values, the mask will be plotted instead.
E.g. I have p-values as plot_values, but I want to plot beta- coefficients that has p-value &lt;0.05 instead. Here the dict of beta coef is the mask.</p></li>
<li><p><strong>fig</strong> (<em>mpl.figure.Figure</em><em>, </em><em>optional</em>) – Can specify the fig, if not fig will be created. The default is None.</p></li>
<li><p><strong>axes</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>,</em><em>List</em><em>]</em><em>, </em><em>optional</em>) – Can provide the specific axes, list of axes. If not axes will be created. The default is None.</p></li>
<li><p><strong>colorbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – If plot_values is specified, then can choose if to plot the colorbar. The default is False.</p></li>
<li><p><strong>label_legend</strong> (<em>dict</em><em>, </em><em>optional</em>) – If not using the plot_values, but you want to show the segmentation.
Each color patch in the legend will correspond to the color in the plot
Must provide a dictionary, where the key is interger denoting the label.
And value is the string abbreviation. The default is None.</p></li>
<li><p><strong>atlas_file</strong> (<em>Union</em><em>[</em><em>str</em><em>,</em><em>nib.nifti1.Nifti1Image</em><em>]</em><em>, </em><em>optional</em>) – The path to the nifti file, or the nib.load(Nifti file). The default is None.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – The color scheme. The default is ‘Spectral’.</p></li>
<li><p><strong>plot_orientation</strong> (<em>bool</em><em>, </em><em>optional</em>) – If you want to plot the axis in the RAS coordinate.</p></li>
<li><p><strong>**figkwargs</strong> (<em>TYPE</em>) – cmap_reversed = if you want to revese the cmap default False
cb_orientation = {‘horizontal’,’vertical’} if you want your change your colorbar orientation. Default horizontal next to the last axes.
cb_title = str. name of the colorbar
figsize = Default (20,10)
outline_label_legends: bool. Default True. The outline is updated if the the same legend is found in two regions.
outline_regions_to_hide: bool. Default True. The outline is not updated after using regions_to_hide.
label_legend_bbox_to_anchor:(-2.5, -1,0,0)
label_legend_ncol : 6
label_legend_loc: ‘lower left’
label_legend_fontsize: ‘medium’ or float</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – DESCRIPTION.</p></li>
<li><p><strong>AttributeError</strong> – DESCRIPTION.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>TYPE</em>) – The mpl.Figure either created or used.</p></li>
<li><p><strong>map_view_dict</strong> (<em>TYPE</em>) – a dictionary containing all atlas array, including ‘im’ plotted.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nimagen.visualisation.Geneset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nimagen.visualisation.</span></span><span class="sig-name descname"><span class="pre">Geneset</span></span><a class="reference internal" href="_modules/nimagen/visualisation.html#Geneset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.Geneset" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.Geneset.create_heatmap">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_set_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes_set_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'GeneSet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes_list_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'genes'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordered_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'P_Frontal_lobe_WM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_table_gene_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Genes_Name'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nimagen/visualisation.html#Geneset.create_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.Geneset.create_heatmap" title="Permalink to this definition"></a></dt>
<dd><p>Create a heatmap of gene set analysis, where the x-axis is the list of genes, and y-axis is the gene set list.
:param gene_set_table: enrichment result in table format
:type gene_set_table: pd.DataFrame
:param <a href="#id7"><span class="problematic" id="id8">|Geneset|P-value for phenotype 1|</span></a> P-value for phenotype 2|List of genes| etc.:
:param genes_set_column: _description_. Defaults to ‘GeneSet’.
:type genes_set_column: str, optional
:param genes_list_column: _description_. Defaults to ‘genes’.
:type genes_list_column: str, optional
:param gene_table: table containing rows of genes (or SNPs) and columns of P-value associated with 1 or 2 phenotypes (usually 1 for variable of interest and 1 taken directly from GWAS schizophrenia). Defaults to None.
:type gene_table: pd.DataFrame, optional</p>
<p>Note:
The following genes name in the FUMA Gene-sets do not correspond with genes name in gene-table
[‘ADGRV1’ if gene == ‘GPR98’ else ‘ADGRB3’ if gene == ‘BAI3’ else gene for gene in FUMA_gene_sets]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>binary np.array, the x axis = list of genes, y axis = gene sets, 1 where there is a presence of the gene in gene set.
all_genes = genes names on the x-axis
gene_sets = genes set names on the y-axis</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>heatmap</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.Geneset.visualise_enrichment_p_value">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">visualise_enrichment_p_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_set_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'adjP'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'GeneSet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colour_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Proportion'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.array</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.array</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/visualisation.html#Geneset.visualise_enrichment_p_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.Geneset.visualise_enrichment_p_value" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.Geneset.visualise_gene_p_value">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">visualise_gene_p_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_genes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_table_gene_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Genes_Name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordered_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'P_Frontal_lobe_WM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coloured_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'P_schizo'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bar_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'N_SNP'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.array</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/nimagen/visualisation.html#Geneset.visualise_gene_p_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.Geneset.visualise_gene_p_value" title="Permalink to this definition"></a></dt>
<dd><p>Visualise the p-value of the genes in genes list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gene_table</strong> (<em>pd.DataFrame</em>) – _description_</p></li>
<li><p><strong>all_genes</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – _description_</p></li>
<li><p><strong>ordered_by</strong> (<em>str</em><em>,</em><em>optional</em>) – the p-value column name to order by</p></li>
<li><p><strong>coloured_by</strong> (<em>str</em><em>, </em><em>optional</em>) – the p-value column name to colour the bar. Defaults to P_schizo.</p></li>
<li><p><strong>bar_number</strong> (<em>str</em><em>, </em><em>optional</em>) – the column name of number of SNPs in the gene. Defaults to N_SNPs.</p></li>
<li><p><strong>p_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – _description_. Defaults to None.</p></li>
<li><p><strong>ax</strong> – the plt.Axes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.Geneset.visualise_heatmap">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">visualise_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">heatmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_genes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_sets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">figkwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/nimagen/visualisation.html#Geneset.visualise_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.Geneset.visualise_heatmap" title="Permalink to this definition"></a></dt>
<dd><p>Visualise the gene-set heatmap</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>heatmap</strong> (<em>np.array</em>) – the heatmap generated by GeneSet.create_heatmap</p></li>
<li><p><strong>all_genes</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the list of genes generated by GeneSet.create_heatmap</p></li>
<li><p><strong>ax</strong> (<em>np.array</em>) – the plt.Ax to plot on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nimagen.visualisation.SimplePlots">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nimagen.visualisation.</span></span><span class="sig-name descname"><span class="pre">SimplePlots</span></span><a class="reference internal" href="_modules/nimagen/visualisation.html#SimplePlots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.SimplePlots" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.SimplePlots.Bar">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Bar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separateby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby_operation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.figure.Figure</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">figkwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nimagen/visualisation.html#SimplePlots.Bar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.SimplePlots.Bar" title="Permalink to this definition"></a></dt>
<dd><p>Create bar plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>,</em><em>pd.DataFrame</em><em>,</em><em>pd.Series</em><em>,</em><em>list</em><em>,</em><em>str</em><em>]</em>) – X-axis. Must be categorical data</p></li>
<li><p><strong>y</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>pd.DataFrame</em><em>, </em><em>pd.Series</em><em>,</em><em>list</em><em>, </em><em>str</em><em>]</em>) – Y-axis. Must be continuous data</p></li>
<li><p><strong>colorby</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>,</em><em>pd.DataFrame</em><em>,</em><em>pd.Series</em><em>,</em><em>list</em><em>,</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Continuous data that can be used to color each bar. The default is
None.</p></li>
<li><p><strong>separateby</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>,</em><em>pd.DataFrame</em><em>,</em><em>pd.Series</em><em>,</em><em>list</em><em>,</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Categorical data that can be used to separate different plots. The
default is None.</p></li>
<li><p><strong>hue</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>,</em><em>pd.DataFrame</em><em>,</em><em>pd.Series</em><em>,</em><em>list</em><em>,</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Categorical data that can be used to separate different bars in the
same plot. The default is None.
If both colorby and hue is defined, then colorby will be ignored.</p></li>
<li><p><strong>order</strong> (<em>Union</em><em>[</em><em>list</em><em>,</em><em>dict</em><em>,</em><em>str</em><em>]</em><em>:</em>) – Define the order of the bars.
Default is ‘y’: This will oder the bar in the ascending order of y
other option include [‘seperateby’,’x’,’hue’,’y’,’colorby’] where
separateby, x and hue can be ordered alphabetically, and y, colorby
ordered numerically. Set order_reversed to True or False to ascending
or descending.
if specific order is required. Provide a dictionary
e.g. {‘x’:[‘a’,’b’,’c’,’d’]} and the bars will order by the list.</p></li>
<li><p><strong>data</strong> (<em>Optional</em><em>[</em><em>pd.DataFrame</em><em>]</em><em>, </em><em>optional</em>) – DataFrame from which to get the values from . The default is None.</p></li>
<li><p><strong>groupby_operation</strong> (<em>Union</em><em>[</em><em>str</em><em>,</em><em>dict</em><em>]</em><em>, </em><em>optional</em>) – perform function to ‘y’ and ‘colorby’
Possible operations include
{sum,mean,max,min,first,last}
if same groupby operation on y and colorby, use string.
if different groupby operations on y and colorby, use dictionary to
define .E.g. {‘y’:’sum’,’colorby’:’max’} will perform sum on ‘y’
values but color each bar by the max colorby value. The default is
‘sum’.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Title of the whole plot. The default is None.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – Label on the x-axis. The default is None.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – Label on the y-axis. The default is None.</p></li>
<li><p><strong>fig</strong> (<em>Optional</em><em>[</em><em>plt.Figure</em><em>]</em><em>,</em><em>optional</em>) – Can use fig defined by the user. Needed if providing ax and requires
colorbar</p></li>
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>plt.Axes</em><em>]</em><em>, </em><em>optional</em>) – Can use ax defined by the user. The default is None.</p></li>
<li><p><strong>**figkwargs</strong> (<em>dict</em>) – <p>yscalelog:bool: if True, y-axis becomes log10scale, default False
alpha: float: set the transparency of the bars. Default 0.5
hline:float: if float defined, then plot a hline line on</p>
<blockquote>
<div><p>y-axis.</p>
</div></blockquote>
<p>hline_label: label of hline
rotation_x:int,float: degree of rotation on the x-ticks
colorbar_axes:List[float]: if multiple subplots, then define the
colorbar position. The list define the co-ordinate of the lower left</p>
<blockquote>
<div><p>corner of the color bar. The last two values defines the width
and height of the bar. default is [0.85, 0.15, 0.01, 0.7]</p>
</div></blockquote>
<p>colorbar_label:str: label on the colorbar.
cmap:str to color the bars if used colorby. See sns cmap for options.</p>
<blockquote>
<div><p>Default is ‘Greens’</p>
</div></blockquote>
<p>cmap_reversed: to reverse the cmap. Default False
xlabel_pos: tuple(float): If multiple subplots, the define position
of the x-label. Default (.48,.01)
ylabel_pos:tuple(float): If multiple subplots, the define position
of the x-label. Default (.1,.5)
figsize:tuple(float or int): define fig size.
barwidth:float: Define bar width. Default 0.35.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>AttributeError</strong> – colorbar_label requires colorby.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>return fig ploted</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>fig</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nimagen.visualisation.SimplePlots.Groupby">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Groupby</span></span><a class="reference internal" href="_modules/nimagen/visualisation.html#SimplePlots.Groupby"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.SimplePlots.Groupby" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.SimplePlots.Groupby.groupby">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">groupby</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/nimagen/visualisation.html#SimplePlots.Groupby.groupby"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.SimplePlots.Groupby.groupby" title="Permalink to this definition"></a></dt>
<dd><p>Perform groupby operation based on several arguments to return a defaultdict dictionary
It is recommended for the args to be discrete or categorical variables (because we are taking the unique values)
Kwargs can be both categorical or continuous. But if it is for a bar plot, it should be continuous variables.
This function is similar to using pd.DataFrame groupby, pd.set_index.
You can have as many level of args or kwargs as you want.
Usage example:</p>
<blockquote>
<div><p>x = [‘foo1’, ‘foo2’, ‘foo1’, ‘foo2’]
y = [-0.4, 0.3, 1.4, 1.3]
color = [‘red’, ‘blue’, ‘red’, ‘red’]
gender = [2, 1, 1, 3]</p>
</div></blockquote>
<p>groupby(x,y=y): will group by x values. to produce
{‘foo1’:{‘y’:[-0.4,1.4]},’foo2’:{‘y’:[0.3,1.3]}}
groupby(x,color,y=y) will group by x and color value to produce
{‘foo1’: {‘blue’: defaultdict(list, {‘y’: []}),</p>
<blockquote>
<div><blockquote>
<div><p>‘red’: defaultdict(list, {‘y’: [-0.4, 1.4]})},</p>
</div></blockquote>
<dl class="simple">
<dt>‘foo2’: {‘blue’: defaultdict(list, {‘y’: [0.3]}),</dt><dd><p>‘red’: defaultdict(list, {‘y’: [1.3]})}}</p>
</dd>
</dl>
</div></blockquote>
<p>grouby(x,color,y=y,gender=gender) will groupby by x and color value to produce
{‘foo1’: {‘blue’: defaultdict(list, {‘y’: [], ‘gender’: []}),</p>
<blockquote>
<div><blockquote>
<div><p>‘red’: defaultdict(list, {‘y’: [-0.4, 1.4], ‘gender’: [2, 1]})},</p>
</div></blockquote>
<dl class="simple">
<dt>‘foo2’: {‘blue’: defaultdict(list, {‘y’: [0.3], ‘gender’: [1]}),</dt><dd><p>‘red’: defaultdict(list, {‘y’: [1.3], ‘gender’: [3]})}})</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>np.ndarray</em>) – set of discrete or categorical variables</p></li>
<li><p><strong>**kwargs</strong> (<em>np.ndarray</em>) – the values to plot (e.g. on y-axis or to color the bar by)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>temp_plot_dict</strong> – A nested dictionary, where the dictionary keys are made up of the <a href="#id3"><span class="problematic" id="id4">*</span></a>args,
and the values in the deepest layer are the <a href="#id5"><span class="problematic" id="id6">**</span></a>kwargs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.SimplePlots.Groupby.groupby_operation">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">groupby_operation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">groupby_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/nimagen/visualisation.html#SimplePlots.Groupby.groupby_operation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.SimplePlots.Groupby.groupby_operation" title="Permalink to this definition"></a></dt>
<dd><p>Perform groupby operation on the output of groupby function.
Performs recursive opening of the nested dictionary to perform some
operations on the last layer of the dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>groupby_dict</strong> (<em>dict</em>) – Nested dictionary, output from groupby function</p></li>
<li><p><strong>operation</strong> (<em>Union</em><em>[</em><em>dict</em><em>,</em><em>str</em><em>]</em>) – operation to be performed on the deepest layer of the nested dictionary
IF str:{‘sum’,’mean’,’count’,’first’,’last’,’max’,’min’}.
This operation will be applied to all lists in the last layer irrespective of the name.
IF dict, the key must be the key of the lists in the last layer.
e.g. {‘y’:’sum’,’color’:’first’}. This will find the key y
in the last layer and perform sum but will find the key color and perform first.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Updated groupby_dict</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.SimplePlots.Scatter">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Scatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combined</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.figure.Figure</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjust_covar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">figkwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/nimagen/visualisation.html#SimplePlots.Scatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.SimplePlots.Scatter" title="Permalink to this definition"></a></dt>
<dd><p>Fit linear regression, where y~x. calculates the pval and beta coefficient.</p>
<p>You can use it to visualise across different populations and generate separate pval and beta coeficient for each population (hue) or for all of them combined
Note: when you have two variables, the pearson’s correlation coefficient is the same as the standardized beta coefs.
:param x: value on x.
:type x: Union[np.ndarray, pd.DataFrame, pd.Series, str]
:param y: value on y.
:type y: Union[np.ndarray, pd.DataFrame, pd.Series, str]
:param data: if providing string x,y, then data will be the dataframe. The default is None.
:type data: Optional[pd.DataFrame], optional
:param hue: separate data point by another value in the dataframe (e.g. cohort). It will calculate separate beta and p-value. The default is None.
:type hue: Optional[str], optional
:param combined: If use, calculate the total (for all hues) p-val and beta coefs. The default is False.
:type combined: Optional[bool], optional
:param title: Title of the graph. The default is None.
:type title: str, optional
:param xlabel: label on x axis. The default is None.
:type xlabel: str, optional
:param ylabel: label on y axis. The default is None.
:type ylabel: str, optional
:param axes: if provided plt.subplots. The default is None.
:type axes: np.array, optional
:param scaling: whether to scale x and y. The default is ‘both’.
:type scaling: str, optional
:param **figkwargs: linewdith: float</p>
<blockquote>
<div><p>markersize: float
legend_loc {outside, inside}
hide_CI=False</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The ax plot.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ax</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.SimplePlots.get_color_pallete">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_color_pallete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colorby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_reversed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/visualisation.html#SimplePlots.get_color_pallete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.SimplePlots.get_color_pallete" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.SimplePlots.return_array">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">return_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">must_be</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="_modules/nimagen/visualisation.html#SimplePlots.return_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.SimplePlots.return_array" title="Permalink to this definition"></a></dt>
<dd><p>Convenience function to take in multiple data types and return numpy array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>,</em><em>pd.DataFrame</em><em>,</em><em>pd.Series</em><em>,</em><em>str</em><em>,</em><em>List</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>,</em><em>float</em><em>,</em>) – int,pd.Series,np.ndarray]]], optional
The variable of interest. The default is None.</p></li>
<li><p><strong>data</strong> (<em>Optional</em><em>[</em><em>pd.DataFrame</em><em>]</em><em>, </em><em>optional</em>) – The pd.DataFrame if providing column names as x. The default is None.</p></li>
<li><p><strong>must_be</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – {str,int,float}. np.ndarray.astype() will be applied The default is None.</p></li>
<li><p><strong>variable_label</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – DESCRIPTION.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – The returned array.</p></li>
<li><p><em>variable_label</em> – the name of the variable x.</p></li>
<li><p><em>column_names</em> – the column of each column in x if x is multi-dimensional.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nimagen.visualisation.SimplePlots.sort_array">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sort_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specific_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/visualisation.html#SimplePlots.sort_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.SimplePlots.sort_array" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nimagen.visualisation.draw_box_plots">
<span class="sig-prename descclassname"><span class="pre">nimagen.visualisation.</span></span><span class="sig-name descname"><span class="pre">draw_box_plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependentVar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independentVar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ancestry_PCs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/visualisation.html#draw_box_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.draw_box_plots" title="Permalink to this definition"></a></dt>
<dd><p>draw box plots by dividing the dataset into high and low risk</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nimagen.visualisation.visualise_heatmap">
<span class="sig-prename descclassname"><span class="pre">nimagen.visualisation.</span></span><span class="sig-name descname"><span class="pre">visualise_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nimagen/visualisation.html#visualise_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nimagen.visualisation.visualise_heatmap" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-nimagen">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-nimagen" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="nimagen" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Hai Le.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>